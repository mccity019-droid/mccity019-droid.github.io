<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title> MC متجر سيارات </title>

<!-- أيقونات -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0e1117;
  color: #fff;
  text-align: center;
}

header {
  padding: 25px;
  background: #161b22;
  border-bottom: 1px solid #30363d;
}

header h1 {
  margin: 0;
}

/* زر تسجيل الدخول */
#login-btn {
  margin-top: 20px;
  padding: 14px 28px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  background: #5865F2;
  color: white;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 10px;
}

#login-btn i {
  font-size: 20px;
}

#login-btn:hover {
  background: #4752c4;
}

#user-area {
  display: none;
  padding: 30px;
}

#username {
  margin-bottom: 25px;
  opacity: 0.9;
}

/* السيارات */
#cars {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
  gap: 20px;
  max-width: 1100px;
  margin: auto;
}

.car {
  background: #161b22;
  border: 1px solid #30363d;
  border-radius: 12px;
  padding: 15px;
}

.car img {
  width: 100%;
  height: 130px;
  object-fit: cover;
  border-radius: 8px;
}

.car h3 {
  margin: 10px 0;
}

.car input {
  width: 100%;
  padding: 6px;
  border-radius: 6px;
  border: none;
  font-size: 13px;
}

.car button {
  margin-top: 10px;
  width: 100%;
  padding: 10px;
  border-radius: 6px;
  border: none;
  background: #238636;
  color: white;
  font-size: 15px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.car button:hover {
  background: #2ea043;
}

#message {
  margin-top: 20px;
  color: #7CFF7C;
}
</style>
</head>

<body>

<header>
  <h1> MC سيارات </h1>
  <button id="login-btn">
    <i class="fa-brands fa-discord"></i>
    تسجيل دخول عبر Discord
  </button>
</header>

<div id="user-area">
  <p id="username"></p>

  <div id="cars">

    <div class="car">
      <img src="https://i.ibb.co/7vVbR1G/car1.jpg">
      <h3><i class="fa-solid fa-car"></i> سيارة A</h3>
      <input class="img-input" value="https://i.ibb.co/7vVbR1G/car1.jpg">
      <button class="order-btn" data-name="سيارة A">
        <i class="fa-solid fa-cart-shopping"></i>
        طلب السيارة
      </button>
    </div>

    <div class="car">
      <img src="https://i.ibb.co/3WbFG7g/car2.jpg">
      <h3><i class="fa-solid fa-car-side"></i> سيارة B</h3>
      <input class="img-input" value="https://i.ibb.co/3WbFG7g/car2.jpg">
      <button class="order-btn" data-name="سيارة B">
        <i class="fa-solid fa-cart-shopping"></i>
        طلب السيارة
      </button>
    </div>

    <div class="car">
      <img src="https://i.ibb.co/Yc5QZ7r/car3.jpg">
      <h3><i class="fa-solid fa-truck"></i> سيارة C</h3>
      <input class="img-input" value="https://i.ibb.co/Yc5QZ7r/car3.jpg">
      <button class="order-btn" data-name="سيارة C">
        <i class="fa-solid fa-cart-shopping"></i>
        طلب السيارة
      </button>
    </div>

  </div>

  <div id="message"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

const CLIENT_ID = '1462902207329468562';
const REDIRECT_URI = 'https://mccity019-droid.github.io/';
const WEBHOOK = 'https://discord.com/api/webhooks/1462906362995675269/dpM3M1eBzKaA3839W-2wQJ1KAsN9GfGu-zuvzxKp32ZqyiLG2AAEHDdOqS6JEh7NzfHj';

let ordered = false;

// تسجيل الدخول (نفس القديم)
document.getElementById("login-btn").onclick = function () {
  location.href =
    "https://discord.com/api/oauth2/authorize" +
    "?client_id=" + CLIENT_ID +
    "&redirect_uri=" + encodeURIComponent(REDIRECT_URI) +
    "&response_type=token" +
    "&scope=identify";
};

// قراءة التوكن
if (location.hash) {
  const p = new URLSearchParams(location.hash.substring(1));
  const token = p.get("access_token");
  if (token) {
    fetch("https://discord.com/api/users/@me", {
      headers: { Authorization: "Bearer " + token }
    })
    .then(r => r.json())
    .then(u => {
      document.getElementById("login-btn").style.display = "none";
      document.getElementById("user-area").style.display = "block";
      document.getElementById("username").innerText =
        "مرحباً " + u.username + "#" + u.discriminator;
    });
  }
}

// الطلب (نفس القديم)
document.querySelectorAll(".order-btn").forEach(btn => {
  btn.onclick = function () {
    if (ordered) {
      document.getElementById("message").innerText =
        "تم إرسال طلبك مسبقًا، أكمل داخل الديسكورد.";
      return;
    }

    const car = btn.dataset.name;
    const img = btn.parentElement.querySelector(".img-input").value;

    fetch(WEBHOOK, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        content: "طلب سيارة جديد\n" +
                 "المستخدم: " + document.getElementById("username").innerText +
                 "\nالسيارة: " + car,
        embeds: [{ title: car, image: { url: img } }]
      })
    }).then(() => {
      ordered = true;
      document.getElementById("message").innerText =
        "تم إرسال الطلب بنجاح.";
    });
  };
});

});
</script>

</body>
</html>
